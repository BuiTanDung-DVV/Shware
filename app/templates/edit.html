{% extends 'base.html' %}

{% block content %}
<main>
    <div class="auth-form">
        <h2>üìù Ch·ªânh s·ª≠a B√†i Vi·∫øt</h2>

        <form action="{{ url_for('post.edit_post', doc_id=post_id) }}" method="post" enctype="multipart/form-data">
            {% with messages = get_flashed_messages(with_categories=true) %}
              {% if messages %}
                <div class="flashes">
                  {% for category, message in messages %}
                    <div class="flash {{ category }}">{{ message }}</div>
                  {% endfor %}
                </div>
              {% endif %}
            {% endwith %}

            <!-- Title -->
            <div class="form-group">
                <label for="title">Ti√™u ƒë·ªÅ *</label>
                <input type="text" id="title" name="title" value="{{ post.title }}" required>
            </div>

            <!-- Description -->
            <div class="form-group">
                <label for="description">M√¥ t·∫£ *</label>
                <textarea id="description" name="description" rows="2" required>{{ post.description }}</textarea>
            </div>

            <!-- Content -->
            <div class="form-group">
                <label for="content">N·ªôi dung b√†i vi·∫øt *</label>
                <textarea id="content" name="content" rows="5" required>{{ post.content }}</textarea>
            </div>

            <!-- Image -->
            <div class="form-group">
                <label>·∫¢nh hi·ªán t·∫°i:</label><br>
                <img src="{{ post.image_url }}" alt="·∫¢nh b√†i vi·∫øt" style="max-width: 300px; border-radius: 8px;">
            </div>

            <div class="form-group">
                <label for="image">C·∫≠p nh·∫≠t ·∫£nh m·ªõi (tu·ª≥ ch·ªçn)</label>
                <input type="file" id="image" name="image" accept="image/*">
            </div>

            <!-- Existing File -->
            {% if post.download_url %}
            <div class="form-group">
                <label>T·ªáp ƒë√≠nh k√®m:</label><br>
                <a href="{{ post.download_url }}" target="_blank">üì¶ T·∫£i t·ªáp xu·ªëng</a>
            </div>
            {% endif %}

            <!-- Tags -->
            <div class="form-group">
                <label for="tags">Th·∫ª (c√°ch nhau b·∫±ng d·∫•u ph·∫©y)</label>
                <input type="text" id="tags" name="tags" value="{{ post.tags|join(', ') }}">
            </div>

            <!-- Submit -->
            <div class="form-actions">
                <button type="submit" class="btn btn-primary">üíæ C·∫≠p nh·∫≠t B√†i Vi·∫øt</button>
                <a href="{{ url_for('post.list_posts') }}" class="btn">‚Ü© Quay l·∫°i</a>
            </div>
        </form>
    </div>
</main>
{% endblock %}
