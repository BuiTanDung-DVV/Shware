{% extends 'base.html' %}

{% block content %}
<main>
    <div class="file-table">
        <h2>üìÅ Danh s√°ch File</h2>

        <!-- Flash messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="flashes">
              {% for category, message in messages %}
                <div class="flash {{ category }}">{{ message }}</div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        {% if files %}
        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Ti√™u ƒë·ªÅ</th>
                        <th>T√°c gi·∫£</th>
                        <th>M√¥ t·∫£</th>
                        <th>Lo·∫°i file</th>
                        <th>K√≠ch th∆∞·ªõc</th>
                        <th>Tags</th>
                        <th>Ng√†y t·∫£i l√™n</th>
                        <th>H√†nh ƒë·ªông</th>
                    </tr>
                </thead>
                <tbody>
                    {% for file in files %}
                    <tr>
                        <td><a href="{{ file.download_url }}" target="_blank">{{ file.title }}</a></td>
                        <td>{{ file.author }}</td>
                        <td>{{ file.description }}</td>
                        <td>{{ file.file_type }}</td>
                        <td>{{ file.file_size }} KB</td>
                        <td>{{ file.tags }}</td>
                        <td>{{ file.upload_date }}</td>
                        <td>
                            <a href="{{ file.download_url }}" class="btn btn-success" target="_blank">‚¨áÔ∏è T·∫£i xu·ªëng</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>

        <!-- Pagination Controls -->
        <div class="pagination">
            {% if page > 1 %}
            <a href="{{ url_for('files.list_files', page=page - 1) }}">‚¨ÖÔ∏è Trang tr∆∞·ªõc</a>
            {% endif %}

            <span>Trang {{ page }} tr√™n {{ total_pages }}</span>

            {% if page < total_pages %}
            <a href="{{ url_for('files.list_files', page=page + 1) }}">Trang ti·∫øp ‚û°Ô∏è</a>
            {% endif %}
        </div>
        {% else %}
        <div class="flash warning">üìÇ Ch∆∞a c√≥ t·ªáp n√†o ƒë∆∞·ª£c t·∫£i l√™n.</div>
        {% endif %}

        <div class="auth-links">
            <a href="{{ url_for('upload.upload_file') }}">‚¨ÖÔ∏è Quay l·∫°i Trang T·∫£i l√™n</a>
        </div>
    </div>
</main>
{% endblock %}