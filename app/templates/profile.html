{% extends "base.html" %} {% from "_formhelpers.html" import render_field %} {%
block title %}User Profile{% endblock %} {% block content %}
<div class="profile-container">
  <h2>User Profile</h2>
  <div class="profile-grid">
    <div class="profile-info">
      <h3>Account Information</h3>
      <img
        src="{{ user_info.avatar }}"
        alt="User Avatar"
        class="profile-avatar"
      />
      <p><strong>Username:</strong> {{ user_info.name or 'Not set' }}</p>
      <p><strong>Email:</strong> {{ user_info.email }}</p>
      <p>
        <strong>Member Since:</strong> {{ user_info.registration_date |
        timestamp_to_date }}
      </p>
    </div>
    <div class="profile-update-form">
      <h3>Update Profile</h3>
      <form method="POST" action="{{ url_for('dashboard.profile') }}">
        {{ form.hidden_tag() }} {{ render_field(form.display_name) }}
        <hr />
        {# Only show password change section if user has a password provider #}
        {% if has_password_provider %}
        <h4>Change Password</h4>
        <p class="text-muted small">
          Leave blank if you don't want to change your password.
        </p>
        {{ render_field(form.current_password) }} {{
        render_field(form.new_password) }} {{
        render_field(form.confirm_new_password) }} {% else %}
        <h4>Password Management</h4>
        <p class="text-muted small">
          You are logged in using a third-party provider (like Google). Manage
          your password through that provider.
        </p>
        {% endif %} {{ render_field(form.submit) }}
      </form>
    </div>
  </div>
</div>

{# Add some basic CSS for layout #}
<style>
  .profile-container {
    max-width: 1100px;
    margin: 20px auto;
    padding: 20px;
    background-color: #f9f9f9;
    border: 1px solid #ddd;
    border-radius: 8px;
  }
  .profile-grid {
    display: grid;
    grid-template-columns: 1fr 2fr;
    gap: 30px;
  }
  .profile-info {
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
  }
  .profile-info h3 {
    margin-bottom: 15px;
  }
  .profile-avatar {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    margin-bottom: 20px;
    object-fit: cover;
  }
  .profile-info p {
    margin-bottom: 10px;
  }
  .profile-update-form h4 {
    margin-top: 20px;
    margin-bottom: 10px;
  }
  .profile-update-form hr {
    margin: 20px 0;
  }
  .profile-update-form .form-group {
    margin-bottom: 20px;
  }
</style>

{% endblock %}
